<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="{{ page.robots | default: 'index, follow' }}">
  <meta name="author" content="{{ page.author | default: site.author }}">
  
  {%- seo -%}
  
  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="{{ '/assets/images/favicon-32x32.png' | relative_url }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ '/assets/images/favicon-16x16.png' | relative_url }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ '/assets/images/apple-touch-icon.png' | relative_url }}">
  <link rel="manifest" href="{{ '/assets/images/site.webmanifest' | relative_url }}">
  
  <!-- Preconnects for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="//www.google-analytics.com">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
  {% if page.extra_css %}
    {% for css in page.extra_css %}
      <link rel="stylesheet" href="{{ css | relative_url }}">
    {% endfor %}
  {% endif %}
  
  <!-- Critical CSS -->
  <style>
    /* Critical above-the-fold styles */
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fff;
      margin: 0;
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
    .nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 0;
      border-bottom: 1px solid #e5e7eb;
    }
    .nav-links {
      display: flex;
      gap: 2rem;
      align-items: center;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .nav-links a {
      text-decoration: none;
      color: #374151;
      font-weight: 500;
      transition: color 0.2s;
    }
    .nav-links a:hover { color: #2563eb; }
    .cta-btn {
      background: #2563eb;
      color: white !important;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      transition: background 0.2s;
    }
    .cta-btn:hover { background: #1d4ed8; }
    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 700;
      font-size: 1.25rem;
      color: #1f2937;
      text-decoration: none;
    }
    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0.5rem;
    }
    @media (max-width: 768px) {
      .nav-links { display: none; }
      .mobile-menu-btn { display: block; }
    }
  </style>
  
  <!-- Structured Data -->
  {% if page.schema or layout.schema %}
    <script type="application/ld+json">
    {{ page.schema | default: layout.schema | jsonify }}
    </script>
  {% endif %}
  
  <!-- Global site schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "{{ site.title }}",
    "url": "{{ site.url }}{{ site.baseurl }}",
    "description": "{{ site.description }}",
    "publisher": {
      "@type": "Organization",
      "name": "{{ site.business.name | default: site.title }}",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ site.logo | absolute_url }}"
      }
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": {
        "@type": "EntryPoint",
        "urlTemplate": "{{ site.url }}{{ site.baseurl }}/search?q={search_term_string}"
      },
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  
  <!-- Analytics -->
  {% if site.google_analytics %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ site.google_analytics }}', {
        'anonymize_ip': true,
        'respect_privacy': true
      });
    </script>
  {% endif %}
</head>

<body class="{{ page.body_class }}">
  <!-- Skip to content for accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <!-- Header -->
  <header class="site-header" role="banner">
    <div class="container">
      <nav class="nav" role="navigation" aria-label="Main navigation">
        <!-- Logo -->
        <a href="{{ '/' | relative_url }}" class="logo" aria-label="{{ site.title }} home">
          {% if site.logo %}
            <img src="{{ site.logo | relative_url }}" alt="{{ site.title }} logo" width="32" height="32">
          {% endif %}
          <span>{{ site.title }}</span>
        </a>
        
        <!-- Desktop Navigation -->
        <ul class="nav-links" role="menubar">
          {% for item in site.navigation %}
            <li role="none">
              <a href="{{ item.url | relative_url }}" 
                 role="menuitem"
                 {% if page.url == item.url %}aria-current="page"{% endif %}
                 title="{{ item.description | default: item.name }}">
                {{ item.name }}
              </a>
            </li>
          {% endfor %}
          <li role="none">
            <a href="{{ '/deals/' | relative_url }}" class="cta-btn" role="menuitem" title="Latest deals">
              üî• Deals
            </a>
          </li>
        </ul>
        
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" aria-label="Open mobile menu" aria-expanded="false">
          <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </nav>
    </div>
  </header>
  
  <!-- Breadcrumbs -->
  {% if page.breadcrumbs != false and page.url != '/' %}
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <div class="container">
        <ol class="breadcrumb-list">
          <li><a href="{{ '/' | relative_url }}">Home</a></li>
          {% assign url_parts = page.url | split: '/' %}
          {% assign url_build = '' %}
          {% for part in url_parts %}
            {% unless part == '' %}
              {% assign url_build = url_build | append: '/' | append: part %}
              {% if forloop.last %}
                <li aria-current="page">{{ page.title | default: part | capitalize }}</li>
              {% else %}
                <li><a href="{{ url_build }}">{{ part | capitalize }}</a></li>
              {% endif %}
            {% endunless %}
          {% endfor %}
        </ol>
      </div>
    </nav>
  {% endif %}
  
  <!-- Main Content -->
  <main id="main-content" class="main-content" role="main">
    {{ content }}
  </main>
  
  <!-- Footer -->
  <footer class="site-footer" role="contentinfo">
    <div class="container">
      <div class="footer-content">
        <!-- Footer Navigation -->
        <nav class="footer-nav" aria-label="Footer navigation">
          <h3>Quick Links</h3>
          <ul>
            {% for item in site.navigation %}
              <li><a href="{{ item.url | relative_url }}">{{ item.name }}</a></li>
            {% endfor %}
            <li><a href="{{ '/sitemap.xml' | relative_url }}">Sitemap</a></li>
          </ul>
        </nav>
        
        <!-- Contact Info -->
        <div class="footer-contact">
          <h3>Contact</h3>
          <p>Email: <a href="mailto:{{ site.contact.email }}">{{ site.contact.email }}</a></p>
          <p>Partnerships: <a href="mailto:{{ site.contact.partnerships }}">{{ site.contact.partnerships }}</a></p>
        </div>
        
        <!-- Social Links -->
        <div class="footer-social">
          <h3>Follow Us</h3>
          <div class="social-links">
            {% if site.social.links %}
              {% for link in site.social.links %}
                {% assign platform = link | split: '/' | slice: 2 %}
                <a href="{{ link }}" target="_blank" rel="noopener" aria-label="Follow us on {{ platform }}">
                  {% case platform %}
                    {% when 'twitter.com' %}üê¶
                    {% when 'facebook.com' %}üìò
                    {% when 'instagram.com' %}üì∏
                    {% when 'youtube.com' %}üì∫
                    {% else %}üîó
                  {% endcase %}
                </a>
              {% endfor %}
            {% endif %}
          </div>
        </div>
      </div>
      
      <!-- Footer Bottom -->
      <div class="footer-bottom">
        <p>&copy; {{ "now" | date: "%Y" }} {{ site.title }}. Built with Jekyll.</p>
        <div class="footer-legal">
          <a href="{{ '/privacy/' | relative_url }}">Privacy Policy</a>
          <a href="{{ '/terms/' | relative_url }}">Terms of Service</a>
          <a href="{{ '/disclosure/' | relative_url }}">Affiliate Disclosure</a>
        </div>
      </div>
    </div>
  </footer>
  
  <!-- JavaScript -->
  <script src="{{ '/assets/js/main.js' | relative_url }}" defer></script>
  {% if page.extra_js %}
    {% for js in page.extra_js %}
      <script src="{{ js | relative_url }}" defer></script>
    {% endfor %}
  {% endif %}
  
  <!-- Mobile Menu Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
      const navLinks = document.querySelector('.nav-links');
      
      if (mobileMenuBtn && navLinks) {
        mobileMenuBtn.addEventListener('click', function() {
          const expanded = this.getAttribute('aria-expanded') === 'true';
          this.setAttribute('aria-expanded', !expanded);
          navLinks.classList.toggle('active');
        });
      }
    });
  </script>
</body>
</html>
